generator client {
  provider     = "prisma-client"
  output       = "../generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email     String    @unique
  password  String    @map("password")
  fullName  String?   @map("full_name")
  avatarUrl String?   @map("avatar_url")
  role      Role      @default(USER)
  createdAt DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime  @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  bookings  Booking[]
  reviews   Review[]

  @@map("users")
}

model Trip {
  id                 String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name               String
  description        String
  location           String
  duration           String
  tour_type          TourType
  label              TripLabel?
  price              Decimal             @db.Decimal(10, 2)
  discount_price     Decimal?            @db.Decimal(10, 2)
  discount_percent   Int?
  accommodation      String
  meals              String
  transportation     String
  group_size         String
  language           String
  age_range          String
  season             String
  category           String
  brochure_url       String?
  additional_info    String?
  createdAt          DateTime            @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt          DateTime            @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  placeId            String?             @map("place_id") @db.Uuid
  capacity           Int                 @default(0)
  additionalServices AdditionalService[]
  bookings           Booking[]
  faqs               Faq[]
  highlights         Highlight[]
  itineraries        Itinerary[]
  features           PackageFeature[]
  reviews            Review[]
  availabilities     TripAvailability[]
  images             TripImage[]
  place              Place?              @relation(fields: [placeId], references: [id])

  @@index([category])
  @@index([placeId])
  @@index([tour_type])
  @@map("trips")
}

model TripImage {
  id     String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  url    String
  tripId String @db.Uuid
  trip   Trip   @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@map("trip_images")
}

model Itinerary {
  id          String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  dayNumber   Int
  location    String
  title       String
  description String?
  tripId      String  @db.Uuid
  trip        Trip    @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@map("itineraries")
}

model PackageFeature {
  id        String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  text      String
  isInclude Boolean
  tripId    String  @db.Uuid
  trip      Trip    @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@map("package_features")
}

model Highlight {
  id     String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  text   String
  tripId String @db.Uuid
  trip   Trip   @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@map("highlights")
}

model Faq {
  id       String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  question String
  answer   String
  tripId   String @db.Uuid
  trip     Trip   @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@map("faqs")
}

model Review {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  comment     String
  rating      Int
  overall     Float
  transport   Float
  food        Float
  hospitality Float
  destination Float
  userId      String   @db.Uuid
  tripId      String   @db.Uuid
  createdAt   DateTime @default(now()) @db.Timestamptz(6)
  trip        Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)
  user        User     @relation(fields: [userId], references: [id])

  @@map("reviews")
}

model TripAvailability {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  date         DateTime
  maxTravelers Int
  bookedCount  Int      @default(0)
  adultPrice   Decimal  @db.Decimal(10, 2)
  childPrice   Decimal  @db.Decimal(10, 2)
  tripId       String   @db.Uuid
  trip         Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@map("trip_availabilities")
}

model AdditionalService {
  id     String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name   String
  price  Decimal @db.Decimal(10, 2)
  unit   String
  tripId String  @db.Uuid
  trip   Trip    @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@map("additional_services")
}

model Booking {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email         String
  firstName     String        @map("first_name")
  lastName      String        @map("last_name")
  phone         String?
  country       String
  address       String
  city          String
  state         String
  zipCode       String        @map("zip_code")
  travelDate    DateTime      @map("travel_date")
  adults        Int           @default(1)
  children      Int           @default(0)
  subtotal      Decimal       @db.Decimal(10, 2)
  totalPrice    Decimal       @map("total_price") @db.Decimal(10, 2)
  paymentMethod PaymentMethod @map("payment_method")
  status        BookingStatus @default(PENDING)
  orderNote     String?
  userId        String?       @db.Uuid
  tripId        String        @db.Uuid
  createdAt     DateTime      @default(now()) @db.Timestamptz(6)
  trip          Trip          @relation(fields: [tripId], references: [id])
  user          User?         @relation(fields: [userId], references: [id])

  @@map("bookings")
}

model Category {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name      String   @unique
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  image     String?
  isActive  Boolean  @default(true)
  order     Int      @default(0)
  slug      String   @unique
  places    Place[]

  @@map("categories")
}

model Place {
  id           String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name         String
  image        String
  categoryId   String        @map("category_id") @db.Uuid
  createdAt    DateTime      @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime      @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  bannerImage  String?
  capital      String?
  currency     String?
  isFeatured   Boolean       @default(false)
  language     String?
  order        Int           @default(0)
  restrictions String?
  shortDesc    String?
  slug         String        @unique
  timezone     String?
  visaRequired Boolean?      @default(false)
  details      PlaceDetails?
  category     Category      @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  trips        Trip[]

  @@index([categoryId])
  @@index([slug])
  @@map("places")
}

model PlaceDetails {
  id                   String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  placeId              String               @unique @map("place_id") @db.Uuid
  popular_places       Json?
  customer_experiences CustomerExperience[]
  place                Place                @relation(fields: [placeId], references: [id], onDelete: Cascade)
  seasonal_info        SeasonalInfo[]

  @@map("place_details")
}

model CustomerExperience {
  id             String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  image          String
  description    String
  placeDetailsId String       @map("place_details_id") @db.Uuid
  createdAt      DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  customerName   String?
  rating         Float?
  visitDate      DateTime?
  placeDetails   PlaceDetails @relation(fields: [placeDetailsId], references: [id], onDelete: Cascade)

  @@map("customer_experiences")
}

model SeasonalInfo {
  id                 String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  season             String
  weather_celsius    String
  weather_fahrenheit String
  highlights         String[]
  perfect_for        String[]
  image              String?
  placeDetailsId     String       @map("place_details_id") @db.Uuid
  createdAt          DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  order              Int          @default(0)
  updatedAt          DateTime     @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  placeDetails       PlaceDetails @relation(fields: [placeDetailsId], references: [id], onDelete: Cascade)

  @@map("seasonal_info")
}

model ServiceSection {
  id         String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  heading    String
  subHeading String?
  isActive   Boolean          @default(true)
  createdAt  DateTime         @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime         @updatedAt @map("updated_at") @db.Timestamptz(6)
  features   ServiceFeature[]

  @@index([isActive])
}

model ServiceFeature {
  id          String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title       String
  description String
  icon        String
  order       Int            @default(0)
  isActive    Boolean        @default(true)
  sectionId   String         @map("section_id") @db.Uuid
  createdAt   DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt   DateTime       @updatedAt @map("updated_at") @db.Timestamptz(6)
  section     ServiceSection @relation(fields: [sectionId], references: [id], onDelete: Cascade)

  @@unique([sectionId, order])
  @@index([sectionId, isActive])
}

model ContactSection {
  id        String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  createdAt DateTime         @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime         @updatedAt @map("updated_at") @db.Timestamptz(6)
  messages  ContactMessage[]
  offices   ContactOffice[]

  @@map("contact_sections")
}

model ContactOffice {
  id           String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title        String
  contact      String
  addressLine1 String
  addressLine2 String
  sectionId    String         @map("section_id") @db.Uuid
  createdAt    DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime       @updatedAt @map("updated_at") @db.Timestamptz(6)
  section      ContactSection @relation(fields: [sectionId], references: [id], onDelete: Cascade)

  @@map("contact_offices")
}

model ContactMessage {
  id            String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name          String
  email         String
  phoneNumber   String
  message       String
  destination   String?
  agreeToPolicy Boolean         @default(false)
  sectionId     String?         @map("section_id") @db.Uuid
  createdAt     DateTime        @default(now()) @map("created_at") @db.Timestamptz(6)
  section       ContactSection? @relation(fields: [sectionId], references: [id])

  @@map("contact_messages")
}

// schema.prisma

model LandingPage {
  id               Int              @id @default(autoincrement())
  aboutSection     AboutSection?
  bestServices     BestServices?
  journeyTimeline  JourneyTimeline?
  whyChooseUs      WhyChooseUs?
  partners         Partner[]
  videoSection     VideoSection?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
}

model AboutSection {
  id            Int         @id @default(autoincrement())
  title         String
  subtitle      String
  description   String
  founderName   String      // English Comment: Flat structure for simplicity
  founderRole   String
  signatureUrl  String
  images        String[]    // Postgres supports string arrays
  landingPage   LandingPage @relation(fields: [landingPageId], references: [id])
  landingPageId Int         @unique
}

model BestServices {
  id            Int           @id @default(autoincrement())
  title         String
  promoBanner   String
  items         ServiceItem[]
  landingPage   LandingPage   @relation(fields: [landingPageId], references: [id])
  landingPageId Int           @unique
}

model ServiceItem {
  id             Int          @id @default(autoincrement())
  icon           String
  label          String
  desc           String
  bestServices   BestServices @relation(fields: [bestServicesId], references: [id])
  bestServicesId Int
}

model JourneyTimeline {
  id            Int             @id @default(autoincrement())
  title         String
  description   String
  historyTitle  String
  historyDesc   String
  events        TimelineEvent[]
  landingPage   LandingPage     @relation(fields: [landingPageId], references: [id])
  landingPageId Int             @unique
}

model TimelineEvent {
  id                Int             @id @default(autoincrement())
  year              Int
  image             String
  journeyTimeline   JourneyTimeline @relation(fields: [journeyTimelineId], references: [id])
  journeyTimelineId Int
}

model WhyChooseUs {
  id            Int       @id @default(autoincrement())
  title         String
  description   String
  features      Feature[]
  landingPage   LandingPage @relation(fields: [landingPageId], references: [id])
  landingPageId Int         @unique
}

model Feature {
  id            Int         @id @default(autoincrement())
  title         String
  color         String
  whyChooseUs   WhyChooseUs @relation(fields: [whyChooseUsId], references: [id])
  whyChooseUsId Int
}

model Partner {
  id            Int         @id @default(autoincrement())
  name          String
  logo          String
  landingPage   LandingPage @relation(fields: [landingPageId], references: [id])
  landingPageId Int
}

model VideoSection {
  id            Int         @id @default(autoincrement())
  videoUrl      String
  thumbnail     String
  landingPage   LandingPage @relation(fields: [landingPageId], references: [id])
  landingPageId Int         @unique
}

enum Role {
  USER
  ADMIN
}

enum TourType {
  SOLO
  FAMILY
}

enum TripLabel {
  SALE_ON
  FEATURED
}

enum PaymentMethod {
  CASH_ON_DELIVERY
  ONLINE_PAYMENT
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
}


